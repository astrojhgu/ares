====
ARES
====
The Accelerated Reionization Era Simulations (ARES) code was designed to
rapidly generate models for the global 21-cm signal. It can also be used as a 
1-D radiative transfer code, stand-alone non-equilibrium chemistry solver, or
global radiation background calculator.

A few papers on how it works:

- 1-D radiative transfer: `Mirocha et al. (2012) <http://adsabs.harvard.edu/abs/2012ApJ...756...94M>`_.
- Uniform backgrounds \& global 21-cm signal: `Mirocha (2014) <http://adsabs.harvard.edu/abs/2014arXiv1406.4120M>`_.

Be warned: this code is still under active development -- use at your own
risk! Correctness of results is not guaranteed.

The `docs <http://ares.readthedocs.org/en/latest/>`_ are still a work in progress.

Getting started
---------------------
To clone a copy and install: ::

    hg clone https://bitbucket.org/mirochaj/ares ares
    cd ares
    python setup.py install

It would be in your best interest to set an environment variable which points
to the ARES install directory, e.g. (in bash) ::

    export ARES=/users/<yourusername>/ares

ARES will look in ``$ARES/input`` for lookup tables of various kinds, e.g.,
the halo mass function (in ``$ARES/input/hmf``), IGM optical depth (in
``$ARES/input/optical_depth``), spectral energy distributions (in
``$ARES/input/seds``), etc.

When you first run the ``setup.py`` script, a few files will be downloaded
automatically:

hmf_ST_logM_1200_4-16_z_1121_4-60.pkl
    Lookup table for the halo mass function. To make your own lookup tables, run
    ``$ARES/input/generate_hmf_tables.py``. You'll need to install 
    `hmf <https://github.com/steven-murray/hmf>`_ for this to work.

initial_conditions.npz
    Evolution of IGM thermal and ionization state computed using the ``CosmoRec``
    code.

optical_depth_H_400x1616_z_10-50_logE_2-4.7.pkl
    IGM optical depth from :math:`10 \leq z \leq 40` and :math:`0.1 \leq h\nu / keV \leq 30` in a neutral
    universe. To make your own lookup tables spanning different redshifts,
    energies, or for prescribed ionization histories, run
    ``$ARES/input/generate_optical_depth_tables.py``.
    
Dependencies
--------------------
You will need:

- `numpy <http://www.numpy.org/>`_
- `scipy <http://www.scipy.org/>`_
- `matplotlib <http://matplotlib.org/>`_

and optionally, 

- `hmf <https://github.com/steven-murray/hmf>`_
- `h5py <http://www.h5py.org/>`_
- `mpi4py <http://mpi4py.scipy.org>`_
- `python-progressbar <https://code.google.com/p/python-progressbar/>`_

Quick Example
--------------
To generate a global 21-cm signal, simply type: ::

    import ares
    
    sim = ares.simulations.Global21cm()      # Initialize a simulation object
    sim.run()                                                  
    
You can examine the contents of ``sim.history``, a dictionary which contains 
the redshift evolution of all IGM physical quantities, or use some built-in 
analysis routines: ::

    anl = ares.analysis.Global21cm(sim)     # Initialize the analysis class
    ax = anl.GlobalSignature()                     
    
If the plot doesn't appear automatically, set ``interactive: True`` in your matplotlibrc file or type: ::

    import matplotlib.pyplot as pl
    pl.show()

See the documentation for more examples.

Documentation
--------------
To generate the documentation locally, ::

    cd $ARES/doc
    make html
    open _build/html/index.html
    
This will open the documentation in a browser. For the above to work, you'll 
need `sphinx <http://sphinx-doc.org/contents.html>`_, which can be installed via
pip: ::

    pip install sphinx

This depends on `numpydoc <https://github.com/numpy/numpydoc>`_, which can also
be installed via pip: ::

    pip install numpydoc

You can also just view the latest build `here <http://ares.readthedocs.org/en/latest/>`_.

Contributors
------------
Primary author: `Jordan Mirocha <https://sites.google.com/site/jordanmirocha/home>`_ (CU-Boulder) 

Additional contributions / corrections / suggestions from:
    
- `Geraint Harker <http://zuserver2.star.ucl.ac.uk/~harkerg/>`_ (UCL)
- Jacob Jost (CU-Boulder)
- `Greg Salvesen <http://jila.colorado.edu/~salvesen/>`_ (CU-Boulder)



